/** 
* @version 2.1.0
* @license MIT
*/
(function(n,t){"use strict";n.module("smart-table",[]).run(["$templateCache",function(n){n.put("template/smart-table/pagination.html",'<nav ng-if="numPages && pages.length >= 2"><ul class="pagination"><li ng-repeat="page in pages" ng-class="{active: page==currentPage}"><a ng-click="selectPage(page)">{{page}}<\/a><\/li><\/ul><\/nav>')}]);n.module("smart-table").constant("stConfig",{pagination:{template:"template/smart-table/pagination.html",itemsByPage:10,displayedPages:5},search:{delay:400,inputEvent:"input"},select:{mode:"single",selectedClass:"st-selected"},sort:{ascentClass:"st-sort-ascent",descentClass:"st-sort-descent",skipNatural:!1},pipe:{delay:100}});n.module("smart-table").controller("stTableController",["$scope","$parse","$filter","$attrs",function(i,r,u,f){function a(n){return n?[].concat(n):[]}function w(){s=a(h(i));p===!0&&g.pipe()}function b(n,t){if(t.indexOf(".")!=-1){var i=t.split("."),e=i.pop(),u=i.join("."),f=r(u)(n);delete f[e];Object.keys(f).length==0&&b(n,u)}else delete n[t]}var k=f.stTable,c=r(k),d=c.assign,h,v=u("orderBy"),y=u("filter"),s=a(c(i)),e={sort:{},search:{},pagination:{start:0}},o,p=!0,g=this,l;f.stSafeSrc&&(h=r(f.stSafeSrc),i.$watch(function(){var n=h(i);return n?n.length:0},function(n){n!==s.length&&w()}),i.$watch(function(){return h(i)},function(n,t){n!==t&&w()}));this.sortBy=function(t,i){return e.sort.predicate=t,e.sort.reverse=i===!0,n.isFunction(t)?e.sort.functionName=t.name:delete e.sort.functionName,e.pagination.start=0,this.pipe()};this.search=function(t,i){var u=e.search.predicateObject||{},f=i?i:"$";return t=n.isString(t)?t.trim():t,r(f).assign(u,t),t||b(u,f),e.search.predicateObject=u,e.pagination.start=0,this.pipe()};this.pipe=function(){var n=e.pagination,r;o=e.search.predicateObject?y(s,e.search.predicateObject):s;e.sort.predicate&&(o=v(o,e.sort.predicate,e.sort.reverse));n.number!==t&&(n.numberOfPages=o.length>0?Math.ceil(o.length/n.number):1,n.start=n.start>=o.length?(n.numberOfPages-1)*n.number:n.start,r=o.slice(n.start,n.start+parseInt(n.number)));d(i,r||o)};this.select=function(n,r){var u=a(c(i)),f=u.indexOf(n);f!==-1&&(r==="single"?(n.isSelected=n.isSelected!==!0,l&&(l.isSelected=!1),l=n.isSelected===!0?n:t):u[f].isSelected=!u[f].isSelected)};this.slice=function(n,t){return e.pagination.start=n,e.pagination.number=t,this.pipe()};this.tableState=function(){return e};this.getFilteredCollection=function(){return o||s};this.setFilterFunction=function(n){y=u(n)};this.setSortFunction=function(n){v=u(n)};this.preventPipeOnWatch=function(){p=!1}}]).directive("stTable",function(){return{restrict:"A",controller:"stTableController",link:function(n,t,i,r){i.stSetFilter&&r.setFilterFunction(i.stSetFilter);i.stSetSort&&r.setSortFunction(i.stSetSort)}}});n.module("smart-table").directive("stSearch",["stConfig","$timeout","$parse",function(n,t,i){return{require:"^stTable",link:function(r,u,f,e){var s=e,o=null,h=f.stDelay||n.search.delay,c=f.stInputEvent||n.search.inputEvent;f.$observe("stSearch",function(n,t){var i=u[0].value;n!==t&&i&&(e.tableState().search={},s.search(i,n))});r.$watch(function(){return e.tableState().search},function(n){var t=f.stSearch||"$";n.predicateObject&&i(t)(n.predicateObject)!==u[0].value&&(u[0].value=i(t)(n.predicateObject)||"")},!0);u.bind(c,function(n){n=n.originalEvent||n;o!==null&&t.cancel(o);o=t(function(){s.search(n.target.value,f.stSearch||"");o=null},h)})}}}]);n.module("smart-table").directive("stSelectRow",["stConfig",function(n){return{restrict:"A",require:"^stTable",scope:{row:"=stSelectRow"},link:function(t,i,r,u){var f=r.stSelectMode||n.select.mode;i.bind("click",function(){t.$apply(function(){u.select(t.row,f)})});t.$watch("row.isSelected",function(t){t===!0?i.addClass(n.select.selectedClass):i.removeClass(n.select.selectedClass)})}}}]);n.module("smart-table").directive("stSort",["stConfig","$parse",function(i,r){return{restrict:"A",require:"^stTable",link:function(u,f,e,o){function p(){s++;h=n.isFunction(l(u))?l(u):e.stSort;s%3==0&&!!w!=!0?(s=0,o.tableState().sort={},o.tableState().pagination.start=0,o.pipe()):o.sortBy(h,s%2==0)}var h=e.stSort,l=r(h),s=0,a=e.stClassAscent||i.sort.ascentClass,v=e.stClassDescent||i.sort.descentClass,y=[a,v],c,w=e.stSkipNatural!==t?e.stSkipNatural:i.sort.skipNatural;e.stSortDefault&&(c=u.$eval(e.stSortDefault)!==t?u.$eval(e.stSortDefault):e.stSortDefault);f.bind("click",function(){h&&u.$apply(p)});c&&(s=c==="reverse"?1:0,p());u.$watch(function(){return o.tableState().sort},function(n){n.predicate!==h?(s=0,f.removeClass(a).removeClass(v)):(s=n.reverse===!0?2:1,f.removeClass(y[s%2]).addClass(y[s-1]))},!0)}}}]);n.module("smart-table").directive("stPagination",["stConfig",function(n){return{restrict:"EA",require:"^stTable",scope:{stItemsByPage:"=?",stDisplayedPages:"=?",stPageChange:"&"},templateUrl:function(t,i){return i.stTemplate?i.stTemplate:n.pagination.template},link:function(t,i,r,u){function f(){var n=u.tableState().pagination,i=1,r,f,e=t.currentPage;for(t.currentPage=Math.floor(n.start/n.number)+1,i=Math.max(i,t.currentPage-Math.abs(Math.floor(t.stDisplayedPages/2))),r=i+t.stDisplayedPages,r>n.numberOfPages&&(r=n.numberOfPages+1,i=Math.max(1,r-t.stDisplayedPages)),t.pages=[],t.numPages=n.numberOfPages,f=i;f<r;f++)t.pages.push(f);e!==t.currentPage&&t.stPageChange({newPage:t.currentPage})}t.stItemsByPage=t.stItemsByPage?+t.stItemsByPage:n.pagination.itemsByPage;t.stDisplayedPages=t.stDisplayedPages?+t.stDisplayedPages:n.pagination.displayedPages;t.currentPage=1;t.pages=[];t.$watch(function(){return u.tableState().pagination},f,!0);t.$watch("stItemsByPage",function(n,i){n!==i&&t.selectPage(1)});t.$watch("stDisplayedPages",f);t.selectPage=function(n){n>0&&n<=t.numPages&&u.slice((n-1)*t.stItemsByPage,t.stItemsByPage)};u.tableState().pagination.number||u.slice(0,t.stItemsByPage)}}}]);n.module("smart-table").directive("stPipe",["stConfig","$timeout",function(t,i){return{require:"stTable",scope:{stPipe:"="},link:{pre:function(r,u,f,e){var o=null;n.isFunction(r.stPipe)&&(e.preventPipeOnWatch(),e.pipe=function(){return o!==null&&i.cancel(o),o=i(function(){r.stPipe(e.tableState(),e)},t.pipe.delay)})},post:function(n,t,i,r){r.pipe()}}}}])})(angular);
//# sourceMappingURL=smart-table.min.js.map
